---
title: bs-platform release 7.1.0
---

`bs-platform@7.1.0` is released, you can try it with `npm i -g bs-platform`!
(if you have permission issues, try `sudo npm i --unsafe-perm -g bs-platform`)

It was called 7.0.2 but bumped into 7.1.0 due to a breaking change (a soundness fix):

Previously, the empty array `[||]` is polymoprhic, this happens to be true since in native, the array is not resizable, so that user can not do any thing with it. But in JS, we introduced a binding `push` which can push elements dynamically. In this case, empty array can not be polymorphic any more.

Removing `push` is possible but it makes array in JS context less useful. To mitigate this issue without removing `push`, we make `[||]` weakly typed so that its type is deferred until the first time it is used. If it is never used across the module, it has to be annotated with a concrete type, otherwise, the type checker will complain.

We introduce several highlighted features as below:

## unboxed types 

One major feature introduced in this release is **unboxed types** which is blogged [here](https://bucklescript.github.io/blog/2019/12/20/release-7-02).

## raw js parsing/checking
Another major feature in this release is that we introduce a js parser (thanks to [flowtype](https://github.com/facebook/flow)) for syntax check and analyzer inside raw, it is on-going work, but is already quite useful now.

First, we will report syntax erors properly for `raw`.

Second, previously we treat content inside raw as blackbox, now we can tell whether the code inside raw is a function or not and the arity of raw function, so that 

```ocaml
let f = [%raw "function(x){return x}"]
```
```reason
let f = [%raw "function(x){return x}"];
```
```ocaml
let f = fun%raw x -> {|x|}
```
```reason
let f = [%raw x => {|x|}];
```
will be treated the same, to make FFI simpler, the special form will be discouraged, we will exploit more to take advantage of the flow parser.

## uniform warning system

Previously the warnings are reported in two styles:
the OCaml compiler style : `-w +10` ;
ad-hoc warnings introduced by flags `-bs-warn-unimplemented-external`.

This is due to the fact OCaml's own warning system can only handle warnings in the type checking pass so that warnings in parsing, code generation are not controlled properly, we did some work to make such integration better. Based on such effort, we move all Bucklescript warnings into OCaml style warnings so that users don't need learn new stuff to deal with BuckleScript warnings.

The introduced warnings are listed here (via `bsc -warn-help`):

```
101 BuckleScript warning: Unused bs attributes
102 BuckleScript warning: polymorphic comparison introduced (maybe unsafe)
103 BuckleScript warning: about fragile FFI definitions
104 BuckleScript warning: bs.deriving warning with customized message 
105 BuckleScript warning: the external name is inferred from val name is unsafe from refactoring when changing value name
106 BuckleScript warning: Unimplemented primitive used:
107 BuckleScript warning: Integer literal exceeds the range of representable integers of type int
108 BuckleScript warning: Uninterpreted delimiters (for unicode)
```

## reason parser upgrade
In this release, we also upgraded `refmt`(the reason parser) to 3.6.0, a notable feature is that the external name can be omitted now:

```
[@bs.obj]
external f : (~x:int)=>_; 
Js.log(f(~x=2));
```
will produce such code:
```js
console.log({
      x: 2
    });

```

A full list of changes are available here: https://github.com/BuckleScript/bucklescript/blob/master/Changes.md#702