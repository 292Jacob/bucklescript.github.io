<!DOCTYPE html><html lang="pt-BR"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Miscellaneous · BuckleScript</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Miscellaneous · BuckleScript"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bucklescript.github.io/index.html"/><meta property="og:description" content="## Composing `bs` Attributes"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/logos/bucklescript.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://bucklescript.github.io/blog/atom.xml" title="BuckleScript Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://bucklescript.github.io/blog/feed.xml" title="BuckleScript Blog RSS Feed"/><script type="text/javascript" src="/js/toggleSyntaxButton.js"></script><script type="text/javascript" src="/js/pjax-api.min.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/pt-BR"><img class="logo" src="/img/logos/bucklescript.svg" alt="BuckleScript"/><h2 class="headerTitleWithLogo">BuckleScript</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/pt-BR/installation.html" target="_self">Docs</a></li><li class=""><a href="/docs/pt-BR/playground.html" target="_self">Try</a></li><li class="siteNavGroupActive"><a href="/docs/pt-BR/stdlib-overview.html" target="_self">API</a></li><li class=""><a href="/docs/pt-BR/community.html" target="_self">Community</a></li><li class=""><a href="/blog" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg"/>Português (Brasil)</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/ja">日本語</a></li><li><a href="/en">English</a></li><li><a href="/es-ES">Español</a></li><li><a href="/fr">Français</a></li><li><a href="/ko">한국어</a></li><li><a href="/ru">Русский</a></li><li><a href="/zh-CN">中文</a></li><li><a href="/zh-TW">繁體中文</a></li><li><a href="https://crowdin.com/project/bucklescript" target="_blank" rel="noreferrer noopener">Help Translate</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/bucklescript/bucklescript" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Interop</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Intro</h3><ul><li class="navListItem"><a class="navItem" href="/docs/pt-BR/what-why.html">What &amp; Why</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/new-project.html">New Project</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/concepts-overview.html">Concepts Overview</a></li></ul></div><div class="navGroup navGroupActive"><h3>Interop</h3><ul><li class="navListItem"><a class="navItem" href="/docs/pt-BR/interop-overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/interop-cheatsheet.html">Cheatsheet</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/embed-raw-javascript.html">Embed Raw JavaScript</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/common-data-types.html">Common Data Types</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/intro-to-external.html">Intro to External</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/bind-to-global-values.html">Bind to Global Values</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/null-undefined-option.html">Null, Undefined &amp; Option</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/object.html">Object</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/object-deprecated.html">Object (Deprecated)</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/class.html">Class</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/function.html">Function</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/import-export.html">Import &amp; Export</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/regular-expression.html">Regular Expression</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/exceptions.html">Exceptions</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/json.html">JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/fast-pipe.html">Fast Pipe</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/generate-converters-accessors.html">Generate Converters &amp; Helpers</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/better-data-structures-printing-debug-mode.html">Better Data Structures Printing (Debug Mode)</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/nodejs-special-variables.html">NodeJS Special Variables</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/pt-BR/interop-misc.html">Miscellaneous</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/browser-support-polyfills.html">Browser Support &amp; Polyfills</a></li></ul></div><div class="navGroup navGroupActive"><h3>Build System</h3><ul><li class="navListItem"><a class="navItem" href="/docs/pt-BR/build-overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/build-configuration.html">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/automatic-interface-generation.html">Automatic Interface Generation</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/interop-with-js-build-systems.html">Interop with JS Build System</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/build-performance.html">Performance</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/build-advanced.html">Advanced</a></li></ul></div><div class="navGroup navGroupActive"><h3>Standard Library</h3><ul><li class="navListItem"><a class="navItem" href="/docs/pt-BR/stdlib-overview.html">Overview</a></li></ul></div><div class="navGroup navGroupActive"><h3>Advanced</h3><ul><li class="navListItem"><a class="navItem" href="/docs/pt-BR/conditional-compilation.html">Conditional Compilation</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/extended-compiler-options.html">Extended Compiler Options</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/use-existing-ocaml-libraries.html">Use Existing OCaml Libraries</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/difference-from-native-ocaml.html">Difference from Native OCaml</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/compiler-architecture-principles.html">Compiler Architecture &amp; Principles</a></li><li class="navListItem"><a class="navItem" href="/docs/pt-BR/comparison-to-jsoo.html">Comparison to Js_of_ocaml</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/bucklescript/pt-BR" target="_blank" rel="noreferrer noopener">Translate</a><h1>Miscellaneous</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="composing-bs-attributes"></a><a href="#composing-bs-attributes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Composing <code>bs</code> Attributes</h2>
<p>As you might have guessed, most <code>bs.*</code> attributes can be used together. Here's an extreme example:</p>
<pre><code class="hljs css ocaml"><span class="hljs-keyword">external</span> draw: (_ [@bs.<span class="hljs-keyword">as</span> <span class="hljs-string">"dog"</span>]) -&gt; <span class="hljs-built_in">int</span> <span class="hljs-built_in">array</span> -&gt; <span class="hljs-built_in">unit</span> = <span class="hljs-string">"draw"</span> [@@bs.<span class="hljs-keyword">val</span>] [@@bs.scope <span class="hljs-string">"global"</span>] [@@bs.splice]

<span class="hljs-keyword">let</span> _ = draw [|<span class="hljs-number">1</span>;<span class="hljs-number">2</span>|]
</code></pre>
<pre><code class="hljs css reason">[@bs.val] [@bs.scope <span class="hljs-string">"global"</span>] [@bs.splice]
external draw : <span class="hljs-function"><span class="hljs-params">([@bs.<span class="hljs-keyword">as</span> <span class="hljs-string">"dog"</span>] _, array(int))</span> =&gt;</span> unit = <span class="hljs-string">"draw"</span>;

draw([|<span class="hljs-number">1</span>, <span class="hljs-number">2</span>|]);
</code></pre>
<p>Output:</p>
<pre><code class="hljs css js">global.draw(<span class="hljs-string">"dog"</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="safe-external-data-handling"></a><a href="#safe-external-data-handling" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Safe External Data Handling</h2>
<p>In some cases, the data could either come from JS or BS; it's very hard to give precise type information because of this. For example, for an external promise whose creation could come from the JS API, its failed value caused by <code>Promise.reject</code> could be of any shape.</p>
<p>BuckleScript provides a solution, <code>bs.open</code>, to filter out OCaml structured exception data from the mixed data source. It preserves type safety while allowing you to deal with mixed source. It makes use of OCaml’s extensible variant, so that users can mix values of type <code>exn</code> with JS data.</p>
<pre><code class="hljs css ocaml"><span class="hljs-keyword">let</span> handleData = <span class="hljs-keyword">function</span> [@bs.<span class="hljs-keyword">open</span>]
 | <span class="hljs-type">Invalid_argument</span> _ -&gt; <span class="hljs-number">0</span>
 | <span class="hljs-type">Not_found</span> -&gt; <span class="hljs-number">1</span>
 | <span class="hljs-type">Sys_error</span> _ -&gt; <span class="hljs-number">2</span>

<span class="hljs-comment">(* val handleData : 'a -&gt; int option *)</span>
</code></pre>
<pre><code class="hljs css reason"><span class="hljs-keyword">let</span> handleData = [@bs.open] (
  <span class="hljs-keyword">fun</span>
  | <span class="hljs-type">Invalid_argument</span>(<span class="hljs-keyword">_</span>) =&gt; <span class="hljs-number">0</span>
  | <span class="hljs-type">Not_found</span> =&gt; <span class="hljs-number">1</span>
  | <span class="hljs-type">Sys_error</span>(<span class="hljs-keyword">_</span>) =&gt; <span class="hljs-number">2</span>
);

<span class="hljs-comment">(* let handleData: 'a =&gt; option(int) *)</span>
</code></pre>
<p>For any input source, as long as it matches the exception pattern (nested pattern match supported), the matched value is returned, otherwise return <code>None</code>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="nodejs-special-variables.html">← NodeJS Special Variables</a><a class="docs-next button" href="browser-support-polyfills.html">Browser Support &amp; Polyfills →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#composing-bs-attributes">Composing <code>bs</code> Attributes</a></li><li><a href="#safe-external-data-handling">Safe External Data Handling</a></li></ul></nav></div><span><script src="/js/redirectBlog.js"></script><script>window.foo = new Pjax({
          areas: [
            // try to use the first query.
            '.mainContainer, .docsNavContainer .toc .navWrapper, .onPageNav',
            // fallback
            'body'
          ],
          link: '.docsNavContainer:not(.docsSliderActive) a',
          update: {
            script: false,
          }
        });
        var languagesMenuItemCopy = document.getElementById("languages-menu");
        languagesMenuItemCopy.addEventListener("click", function(e){
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
        });</script></span></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: '0fd97db83891aa20810559812d9e69ac',
                indexName: 'bucklescript',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["lang:pt-BR"]}
              });
            </script></body></html>