<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Better Data Structures Printing (Debug Mode) · BuckleScript</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Better Data Structures Printing (Debug Mode) · BuckleScript"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bucklescript.github.io/index.html"/><meta property="og:description" content="You might have seen that using `Js.log` to print records, variants and others don&#x27;t print out record field names and variant tags. Record, for example, is compiled into an array (the field names are removed). This is partially for performance, and partially because of [insert excuse here]."/><link rel="shortcut icon" href="/img/logos/bucklescript_small.svg"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://bucklescript.github.io/blog/atom.xml" title="BuckleScript Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://bucklescript.github.io/blog/feed.xml" title="BuckleScript Blog RSS Feed"/><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logos/bucklescript_small.svg"/><h2 class="headerTitle">BuckleScript</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/docs/fr/installation.html" target="_self">Docs</a></li><li><a href="/docs/fr/playground.html" target="_self">Try</a></li><li><a href="/docs/fr/stdlib-overview.html" target="_self">API</a></li><li><a href="/docs/fr/community.html" target="_self">Community</a></li><li><a href="/blog" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg"/>Français</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/ja">日本語</a></li><li><a href="/en">English</a></li><li><a href="/es-ES">Español</a></li><li><a href="/ko">한국어</a></li><li><a href="/pt-BR">Português (Brasil)</a></li><li><a href="/ru">Русский</a></li><li><a href="/zh-CN">中文</a></li><li><a href="/zh-TW">繁體中文</a></li><li><a href="https://crowdin.com/project/bucklescript" target="_blank">Help Translate</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/bucklescript/bucklescript" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Interop</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Intro</h3><ul><li class="navListItem"><a class="navItem" href="/docs/fr/what-why.html">What &amp; Why</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/new-project.html">New Project</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/concepts-overview.html">Vue d’Ensemble des Concepts</a></li></ul></div><div class="navGroup navGroupActive"><h3>Interop</h3><ul><li class="navListItem"><a class="navItem" href="/docs/fr/interop-overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/interop-cheatsheet.html">Cheatsheet</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/embed-raw-javascript.html">Embed Raw JavaScript</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/common-data-types.html">Types de données communs</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/intro-to-external.html">Intro to External</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/bind-to-global-values.html">Bind to Global Values</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/null-undefined-option.html">Null, Undefined &amp; Option</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/object.html">Object</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/object-deprecated.html">Object (Deprecated)</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/class.html">Class</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/function.html">Function</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/import-export.html">Import &amp; Export</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/regular-expression.html">Regular Expression</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/exceptions.html">Exceptions</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/json.html">JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/fast-pipe.html">Fast Pipe</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/generate-converters-accessors.html">Generate Converters &amp; Helpers</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/fr/better-data-structures-printing-debug-mode.html">Better Data Structures Printing (Debug Mode)</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/nodejs-special-variables.html">NodeJS Special Variables</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/interop-misc.html">Miscellaneous</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/browser-support-polyfills.html">Support navigateur et Polyfills</a></li></ul></div><div class="navGroup navGroupActive"><h3>Build System</h3><ul><li class="navListItem"><a class="navItem" href="/docs/fr/build-overview.html">Vue d&#x27;ensemble</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/build-configuration.html">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/automatic-interface-generation.html">Automatic Interface Generation</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/interop-with-js-build-systems.html">Interop with JS Build System</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/build-performance.html">Performance</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/build-advanced.html">Advanced</a></li></ul></div><div class="navGroup navGroupActive"><h3>Standard Library</h3><ul><li class="navListItem"><a class="navItem" href="/docs/fr/stdlib-overview.html">Overview</a></li></ul></div><div class="navGroup navGroupActive"><h3>Advanced</h3><ul><li class="navListItem"><a class="navItem" href="/docs/fr/conditional-compilation.html">Compilation Conditionnelle</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/extended-compiler-options.html">Extended Compiler Options</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/use-existing-ocaml-libraries.html">Use Existing OCaml Libraries</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/difference-from-native-ocaml.html">Différence avec OCaml Natif</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/compiler-architecture-principles.html">Architecture du Compilateur &amp; Principes</a></li><li class="navListItem"><a class="navItem" href="/docs/fr/comparison-to-jsoo.html">Comparison to Js_of_ocaml</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/bucklescript/fr" target="_blank">Translate</a><h1>Better Data Structures Printing (Debug Mode)</h1></header><article><div><span><p>You might have seen that using <code>Js.log</code> to print records, variants and others don't print out record field names and variant tags. Record, for example, is compiled into an array (the field names are removed). This is partially for performance, and partially because of [insert excuse here].</p>
<p>To remediate this, we introduce a flag for <code>bsc</code> (the BuckleScript compiler), <code>-bs-g</code>, that retains record fields names, variant tags, exception names, module names, etc.</p>
<table>
  <thead> <tr><th>Before</th><th>After</th></tr> </thead>
  <tbody>
    <tr>
      <td>
        <img src="/img/debugger-before.png" alt="debugger before">
      </td>
      <td style="vertical-align: middle">
        <img src="/img/debugger-after.png" alt="debugger after">
      </td>
    </tr>
  </tbody>
</table>
<p><strong>Note</strong>: this is for <strong>debugging only</strong>. Please don't forget to undo this for production.</p>
<h2><a class="anchor" aria-hidden="true" name="usage"></a><a href="#usage" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Usage</h2>
<ul>
<li>Add <code>&quot;bsc-flags&quot;: [&quot;-bs-g&quot;]</code> to your <code>bsconfig.json</code>.</li>
<li>In the BuckleScript/Reason file you'd like to debug, add <code>[%%debugger.chrome]</code> at the top *.</li>
<li>If you're on Node.js, run: <code>node --inspect-brk MyCompiledFile.js</code> and open this URL in Chrome: <code>chrome://inspect</code>.</li>
<li>Click on inspect, then step through code as you would usually:</li>
</ul>
<p><img src="/img/debugger-inspector.png" alt="debugger inspector"></p>
<p>This custom formatter is still experimental; feel free to contribute to it <a href="https://github.com/BuckleScript/bucklescript/blob/master/jscomp/others/belt_Debug.ml">here</a>!</p>
<p><strong>Note</strong>: you need to restart <code>node</code> every time your files changes.</p>
<p><strong>Note</strong>: don't forget to remove <code>-bs-g</code> from your <code>bsconfig.json</code> for production!</p>
<h2><a class="anchor" aria-hidden="true" name="tips-tricks"></a><a href="#tips-tricks" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tips &amp; Tricks</h2>
<p><a href="https://nodejs.org/en/docs/guides/debugging-getting-started/#inspector-clients">Here are other ways</a> to debug using node/Chrome.</p>
<p>* The extension <code>[%%debugger.chrome]</code> conditionally turns on the debugger support. Feel free to keep it on at all time; it will not generate any extra garbage code <strong>unless</strong> you have <code>-bs-g</code> flag turned on above.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="generate-converters-accessors.html">← Generate Converters &amp; Helpers</a><a class="docs-next button" href="nodejs-special-variables.html">NodeJS Special Variables →</a></div></div></div></div><span><script src="/js/redirectBlog.js"></script><script src="/js/pjax-api.js"></script><script>window.foo = new Pjax({
          areas: [
            // try to use the first query.
            '.mainContainer, .docsNavContainer .toc .navWrapper',
            // fallback
            'body'
          ],
          link: '.docsNavContainer:not(.docsSliderActive) a',
          update: {
            script: false,
          }
        });
        var languagesMenuItemCopy = document.getElementById("languages-menu");
        languagesMenuItemCopy.addEventListener("click", function(e){
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
        });</script></span></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: '0fd97db83891aa20810559812d9e69ac',
                indexName: 'bucklescript',
                inputSelector: '#search_input_react'
              });
            </script></body></html>