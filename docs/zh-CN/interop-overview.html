<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>总览 · BuckleScript</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="总览 · BuckleScript"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bucklescript.github.io/index.html"/><meta property="og:description" content="Interop 是 interoperability （互操作）的缩写，在BuckleScript中，Interop表示与javascript进行通信。 BuckleScript的核心目标之一就是尽可能平滑的与跨堆栈javascript进行交互。"/><link rel="shortcut icon" href="/img/logos/bucklescript_small.svg"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://bucklescript.github.io/blog/atom.xml" title="BuckleScript Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://bucklescript.github.io/blog/feed.xml" title="BuckleScript Blog RSS Feed"/><script type="text/javascript" src="/js/toggleSyntaxButton.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logos/bucklescript_small.svg"/><h2 class="headerTitle">BuckleScript</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/docs/zh-CN/installation.html" target="_self">文档</a></li><li><a href="/docs/zh-CN/playground.html" target="_self">Try</a></li><li><a href="/docs/zh-CN/stdlib-overview.html" target="_self">API</a></li><li><a href="/docs/zh-CN/community.html" target="_self">社区</a></li><li><a href="/blog" target="_self">博客</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/ja">日本語</a></li><li><a href="/en">English</a></li><li><a href="/es-ES">Español</a></li><li><a href="/fr">Français</a></li><li><a href="/ko">한국어</a></li><li><a href="/pt-BR">Português (Brasil)</a></li><li><a href="/ru">Русский</a></li><li><a href="/zh-TW">繁體中文</a></li><li><a href="https://crowdin.com/project/bucklescript" target="_blank">帮助我们翻译</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/bucklescript/bucklescript" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Interop</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>简介</h3><ul><li class="navListItem"><a class="navItem" href="/docs/zh-CN/what-why.html">什么 &amp; 为什么</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/installation.html">安装</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/new-project.html">新建项目</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/concepts-overview.html">概念一览</a></li></ul></div><div class="navGroup navGroupActive"><h3>互操作</h3><ul><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/zh-CN/interop-overview.html">总览</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/interop-cheatsheet.html">备忘清单</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/embed-raw-javascript.html">嵌入原生Javascript</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/common-data-types.html">通用数据类型</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/intro-to-external.html">External简介</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/bind-to-global-values.html">全局变量</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/null-undefined-option.html">Null， Undefined， Option</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/object.html">对象</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/object-deprecated.html">Object (Deprecated)</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/class.html">类</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/function.html">函数</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/import-export.html">导入 / 导出</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/regular-expression.html">正则表达式</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/exceptions.html">Exceptions</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/json.html">JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/fast-pipe.html">Fast Pipe</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/generate-converters-accessors.html">Generate Converters &amp; Helpers</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/better-data-structures-printing-debug-mode.html">Better Data Structures Printing (Debug Mode)</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/nodejs-special-variables.html">NodeJS 特殊变量</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/interop-misc.html">Miscellaneous</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/browser-support-polyfills.html">浏览器支持和兼容</a></li></ul></div><div class="navGroup navGroupActive"><h3>构建系统</h3><ul><li class="navListItem"><a class="navItem" href="/docs/zh-CN/build-overview.html">总览</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/build-configuration.html">配置</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/automatic-interface-generation.html">Automatic Interface Generation</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/interop-with-js-build-systems.html">Interop with JS Build System</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/build-performance.html">性能</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/build-advanced.html">高级</a></li></ul></div><div class="navGroup navGroupActive"><h3>标准库</h3><ul><li class="navListItem"><a class="navItem" href="/docs/zh-CN/stdlib-overview.html">总览</a></li></ul></div><div class="navGroup navGroupActive"><h3>进阶</h3><ul><li class="navListItem"><a class="navItem" href="/docs/zh-CN/conditional-compilation.html">Conditional Compilation</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/extended-compiler-options.html">Extended Compiler Options</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/use-existing-ocaml-libraries.html">使用现有的 OCaml 库</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/difference-from-native-ocaml.html">Difference from Native OCaml</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/compiler-architecture-principles.html">Compiler Architecture &amp; Principles</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/comparison-to-jsoo.html">Comparison to Js_of_ocaml</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/bucklescript/zh-CN" target="_blank">Translate</a><h1>总览</h1></header><article><div><span><p>Interop 是 interoperability （互操作）的缩写，在BuckleScript中，Interop表示与javascript进行通信。 BuckleScript的核心目标之一就是尽可能平滑的与跨堆栈javascript进行交互。</p>
<p>实际开发中，一个常规的代码库，很难在短短几天之内，从一种技术转换成另一种技术的实现，这个过程可能会花费几个月甚至几年。 对于一个互操作性没有充分仔细的被设计的语言， 如果还在犹豫是否应该引入到代码库中的时候，转换代价在初期将成为这个语言的价值的短板，并最终放弃这个语言。</p>
<p>一个精心设计的互操作性的语言应该是简单，高效，本地的和非指令性的，允许开发者使用熟悉的概念去使用这个语言，并且应该是足够自信的去推荐给对这个技术不是很了解的上级管理者，并且当用于团队的项目之后应该是高产的。</p>
<h2><a class="anchor" aria-hidden="true" name=""></a><a href="#" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>申明</h2>
<p>上面的小节可能听起来有点buzzword-y，这也是为什么我们从栈的最底层到最上层的设计了BuckleScript的互操作。</p>
<h3><a class="anchor" aria-hidden="true" name=""></a><a href="#" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>变量</h3>
<p>大部分变量的名称能被编译成了干净的js名称， <code>hello</code>编译成了<code>hello</code>，但有些可能会编译成比如<code>__$INTERNAL$hello$1</code>， 干净的名称（没有被混淆过的）能够更好的调试。 我们见过一个团队中，有对BuckleScript和Reason不是那么熟悉的成员需要紧急修复bug的场景，直接在BuckScript文件中写一段原始的js代码。 邻人欣慰的是BuckleScript设计了这样的&quot;最后逃生窗口&quot;，实在没招的情况下这种方式也是支持的。</p>
<h3><a class="anchor" aria-hidden="true" name=""></a><a href="#" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>数据结构</h3>
<p>BuckleScript（简称BS）的主要数据结构完全映射到了JS的数据结构，例如，BS 中的string 就是js中的string，BS 中的 array 就是 js中的 array，下面就是BS的代码：</p>
<pre><code class="hljs css ocaml"><span class="hljs-keyword">let</span> messages = [| <span class="hljs-string">"hello"</span>; <span class="hljs-string">"world"</span>; <span class="hljs-string">"how"</span>; <span class="hljs-string">"are"</span>; <span class="hljs-string">"you"</span> |]
</code></pre>
<pre><code class="hljs css reason"><span class="hljs-attribute">let messages</span> = [|<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>, <span class="hljs-string">"how"</span>, <span class="hljs-string">"are"</span>, <span class="hljs-string">"you"</span>|];
</code></pre>
<p>Roughly compiles to the JS code:</p>
<pre><code class="hljs css js"><span class="hljs-keyword">var</span> messages = [<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>, <span class="hljs-string">"how"</span>, <span class="hljs-string">"are"</span>, <span class="hljs-string">"you"</span>]
</code></pre>
<p>There is zero mental and performance overhead while using such value. Naturally, the value on the BuckleScript side is automatically typed to be an array of strings.</p>
<p>This behavior doesn't hold for complex data structures; the dedicated sections for each offer more info.</p>
<h3><a class="anchor" aria-hidden="true" name=""></a><a href="#" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数</h3>
<p>In most cases, you can directly call a JS function from BS, and vice-versa! These calls are free of performance overhead in most cases.</p>
<h3><a class="anchor" aria-hidden="true" name=""></a><a href="#" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模块/文件</h3>
<p>Every <code>let</code> declarations in a BS file is exported by default and usable from JS. For the other way around, you can declare in a BS file what JS module you want to use inside BS. We can both output and consume CommonJS, ES6 and AMD modules.</p>
<p>The generated output is clean enough that it could be passed as (slightly badly indented) hand-written JavaScript code. Try a few snippets in our playground!</p>
<!-- TODO: add default export explaination >
<!-- TODO: playground link -->
<h3><a class="anchor" aria-hidden="true" name=""></a><a href="#" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>构建系统</h3>
<p>BS comes with a lightning-fast (fastest?) build system. It starts up in a few <strong>milliseconds</strong> and shuts down as fast. Incremental compilation is <strong>two digits of milliseconds</strong>. This allows the build system to be inserted invisibly into your whole JS build pipeline without embarrassing it. Unless your JS build pipeline is already embarrassingly slow. That's ok.</p>
<p><strong>1</strong> BS file compiles to <strong>1</strong> JS file. The build can be configured to generate JS files alongside or outside your <code>ml</code>/<code>re</code> source files. This means you don't have to ask the infra team's help in trying out BuckleScript at the company; simply generate the JS files and check them in. From the perspective of the rest of the compilation pipeline, it's as if you've written these JS files by hand. This is how <a href="https://reasonml.github.io/blog/2017/09/08/messenger-50-reason.html">Messenger successfully introduced Reason into the codebase</a>.</p>
<h3><a class="anchor" aria-hidden="true" name=""></a><a href="#" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>包管理</h3>
<p>We use NPM and Yarn. Since the generated output is clean enough, you can publish them at NPM <code>prepublishOnly</code> time and remove all trace of BuckleScript beforehand. The consumer wouldn't even know you wrote in BS, not JS! Check your <code>node_modules</code> right now; you might have been using some transitive BS code without knowing!</p>
<h2><a class="anchor" aria-hidden="true" name=""></a><a href="#" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>结论</h2>
<p>Hopefully you can see from the previous overview that we've poured <em>lots</em> of thoughts into simplicity, familiarity and performance in the interop architecture. The next few sections describe each of these points in detail.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="concepts-overview.html">← 概念一览</a><a class="docs-next button" href="interop-cheatsheet.html">备忘清单 →</a></div></div></div></div><span><script src="/js/redirectBlog.js"></script><script src="/js/pjax-api.js"></script><script>window.foo = new Pjax({
          areas: [
            // try to use the first query.
            '.mainContainer, .docsNavContainer .toc .navWrapper',
            // fallback
            'body'
          ],
          link: '.docsNavContainer:not(.docsSliderActive) a',
          update: {
            script: false,
          }
        });
        var languagesMenuItemCopy = document.getElementById("languages-menu");
        languagesMenuItemCopy.addEventListener("click", function(e){
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
        });</script></span></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: '0fd97db83891aa20810559812d9e69ac',
                indexName: 'bucklescript',
                inputSelector: '#search_input_react'
              });
            </script></body></html>