<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>既存のOCamlのライブラリを使う · BuckleScript</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="既存のOCamlのライブラリを使う · BuckleScript"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bucklescript.github.io/index.html"/><meta property="og:description" content="&gt; This section is reserved for advanced usages. Usually, you&#x27;d pick an OCaml/Reason library that&#x27;s already configured to work with our higher-level build system `bsb` (aka has a `bsconfig.json`). If not, you&#x27;d usually add a `bsconfig.json` to it. But if you want to directly use an OCaml package that&#x27;s not part of the npm workflow, or are building some quirky infra with BuckleScript, keep reading!"/><link rel="shortcut icon" href="/img/logos/bucklescript_small.svg"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://bucklescript.github.io/blog/atom.xml" title="BuckleScript Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://bucklescript.github.io/blog/feed.xml" title="BuckleScript Blog RSS Feed"/><script type="text/javascript" src="/js/toggleSyntaxButton.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logos/bucklescript_small.svg"/><h2 class="headerTitle">BuckleScript</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/docs/ja/installation.html" target="_self">ドキュメント</a></li><li><a href="/docs/ja/playground.html" target="_self">試してみる</a></li><li><a href="/docs/ja/stdlib-overview.html" target="_self">API</a></li><li><a href="/docs/ja/community.html" target="_self">コミュニティ</a></li><li><a href="/blog" target="_self">ブログ</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg"/>日本語</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/en">English</a></li><li><a href="/es-ES">Español</a></li><li><a href="/fr">Français</a></li><li><a href="/ko">한국어</a></li><li><a href="/pt-BR">Português (Brasil)</a></li><li><a href="/ru">Русский</a></li><li><a href="/zh-CN">中文</a></li><li><a href="/zh-TW">繁體中文</a></li><li><a href="https://crowdin.com/project/bucklescript" target="_blank">翻訳に参加する</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/bucklescript/bucklescript" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Advanced</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>はじめに</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/what-why.html">What &amp; Why</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/installation.html">インストール</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/new-project.html">新しいプロジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/concepts-overview.html">基本コンセプト</a></li></ul></div><div class="navGroup navGroupActive"><h3>相互運用</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/interop-overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/interop-cheatsheet.html">チートシート</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/embed-raw-javascript.html">生の JavaScript を埋め込む</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/common-data-types.html">基本的なデータ型</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/intro-to-external.html">Intro to External</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/bind-to-global-values.html">グローバル変数のバインド</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/null-undefined-option.html">Null、Undefined、オプション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/object.html">オブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/object-deprecated.html">Object (Deprecated)</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/class.html">クラス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/function.html">関数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/import-export.html">インポート / エクスポート</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/regular-expression.html">正規表現</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/exceptions.html">例外</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/json.html">JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/fast-pipe.html">Fast Pipe</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/generate-converters-accessors.html">コンバーターとヘルパーの生成</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/better-data-structures-printing-debug-mode.html">Better Data Structures Printing (Debug Mode)</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/nodejs-special-variables.html">NodeJS の特殊な変数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/interop-misc.html">その他</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/browser-support-polyfills.html">ブラウザー対応と Polyfill</a></li></ul></div><div class="navGroup navGroupActive"><h3>ビルドシステム</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/build-overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/build-configuration.html">設定</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/automatic-interface-generation.html">インターフェースの自動生成</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/interop-with-js-build-systems.html">JavaScript ビルド システムとの相互運用</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/build-performance.html">パフォーマンス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/build-advanced.html">高度な設定</a></li></ul></div><div class="navGroup navGroupActive"><h3>標準ライブラリ</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/stdlib-overview.html">概要</a></li></ul></div><div class="navGroup navGroupActive"><h3>高度な設定</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/conditional-compilation.html">条件付きコンパイル</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/extended-compiler-options.html">拡張コンパイラ オプション</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/ja/use-existing-ocaml-libraries.html">既存のOCamlのライブラリを使う</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/difference-from-native-ocaml.html">ネイティブ OCaml との違い</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/compiler-architecture-principles.html">コンパイラのアーキテクチャと原則</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/comparison-to-jsoo.html">Js_of_ocaml との比較</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/bucklescript/ja" target="_blank">Translate</a><h1>既存のOCamlのライブラリを使う</h1></header><article><div><span><blockquote>
<p>This section is reserved for advanced usages. Usually, you'd pick an OCaml/Reason library that's already configured to work with our higher-level build system <code>bsb</code> (aka has a <code>bsconfig.json</code>). If not, you'd usually add a <code>bsconfig.json</code> to it. But if you want to directly use an OCaml package that's not part of the npm workflow, or are building some quirky infra with BuckleScript, keep reading!</p>
</blockquote>
<p>This guide is also a small walkthrough of how <code>bsb</code> works under the hood.</p>
<h2><a class="anchor" aria-hidden="true" name="built-in-npm-support"></a><a href="#built-in-npm-support" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Built in NPM support</h2>
<h3><a class="anchor" aria-hidden="true" name="build-an-ocaml-library-as-a-npm-package"></a><a href="#build-an-ocaml-library-as-a-npm-package" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Build an OCaml Library as a NPM Package</h3>
<p><strong>Note</strong>: this section might be slightly stale. If any of the steps aren't working, please file us an issue! Thanks.</p>
<p><strong>We highly recommend</strong> you try this endeavour on a dependency-less library first. It'd avoid lots of trouble.</p>
<p>BuckleScript's compiler, <code>bsc</code>, extends the OCaml compiler options with several flags to provide a better experience for NPM users.</p>
<p>In general, you are expected to see two kinds of build artifacts: the generated JS files and metadata that your OCaml dependencies rely on.</p>
<p>Since CommonJS has no namespaces, to allow JS files to live in different directories, we have a flag</p>
<pre><code class="hljs css sh">bsc.exe -bs-package-name <span class="hljs-variable">$npm_package_name</span> -bs-package-output modulesystem:path/to/your/js/dir -c a.ml
</code></pre>
<p>By passing this flag, <code>bsc.exe</code> will store your <code>package_name</code> and relative path to <code>package.json</code> in <code>.cmj</code> files. It will also generate JS files in the directory you specified. You can, and are encouraged to, store JavaScript files in a hierarchical directory.</p>
<p>For the binary artifacts (Note that this is not necessary if you only want your libraries to be consumed by JS developers, and it has benefit since end users don’t need these binary data any more), the convention is to store all <code>*.cm</code> data in a <em>single</em> directory <code>package.json/lib/ocaml</code> and Javascript files in a <em>hierachical</em> directory like <code>package.json/lib/js</code>.</p>
<h3><a class="anchor" aria-hidden="true" name="use-an-ocaml-library-as-a-npm-package"></a><a href="#use-an-ocaml-library-as-a-npm-package" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Use an OCaml Library as a NPM Package</h3>
<p>If you follow the layout convention above, using an OCaml package is pretty straightforward:</p>
<pre><code class="hljs css sh">bsc.exe -I path/to/ocaml/package/installed -c a.ml
</code></pre>
<h3><a class="anchor" aria-hidden="true" name="together"></a><a href="#together" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Together</h3>
<p>Your command line would be like this:</p>
<pre><code class="hljs css sh">bsc.exe -I path/to/ocaml/package1/installed -I path/to/ocaml/package2/installed  -bs-package-name <span class="hljs-variable">$npm_package_name</span> -bs-package-output commonjs:path/to/lib/js/ -c a.ml
</code></pre>
<h3><a class="anchor" aria-hidden="true" name="examples"></a><a href="#examples" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h3>
<p>You can see a more elaborate <code>bsc</code> setup like so:</p>
<pre><code class="hljs css sh">bsb -init dummy-project
<span class="hljs-built_in">cd</span> dummy-project
npm run build
cat lib/bs/build.ninja
</code></pre>
<p>The <a href="https://ninja-build.org">Ninja</a> file, generated by <code>bsb</code>, describes the exact steps needed to build a trivial project using <code>bsc</code>.</p>
<p>Additionally, please consult <a href="https://github.com/chenglou/intro-to-reason-compilation">https://github.com/chenglou/intro-to-reason-compilation</a>, which covers the lowest-level <a href="https://reasonml.github.io">Reason</a> + BuckleScript compilation mechanisms.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="extended-compiler-options.html">← 拡張コンパイラ オプション</a><a class="docs-next button" href="difference-from-native-ocaml.html">ネイティブ OCaml との違い →</a></div></div></div></div><span><script src="/js/redirectBlog.js"></script><script src="/js/pjax-api.js"></script><script>window.foo = new Pjax({
          areas: [
            // try to use the first query.
            '.mainContainer, .docsNavContainer .toc .navWrapper',
            // fallback
            'body'
          ],
          link: '.docsNavContainer:not(.docsSliderActive) a',
          update: {
            script: false,
          }
        });
        var languagesMenuItemCopy = document.getElementById("languages-menu");
        languagesMenuItemCopy.addEventListener("click", function(e){
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
        });</script></span></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: '0fd97db83891aa20810559812d9e69ac',
                indexName: 'bucklescript',
                inputSelector: '#search_input_react'
              });
            </script></body></html>