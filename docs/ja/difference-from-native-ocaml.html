<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>ネイティブ OCaml との違い · BuckleScript</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="ネイティブ OCaml との違い · BuckleScript"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bucklescript.github.io/index.html"/><meta property="og:description" content="This is particularly important when porting an existing OCaml application to JavaScript."/><link rel="shortcut icon" href="/img/logos/bucklescript_small.svg"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://bucklescript.github.io/blog/atom.xml" title="BuckleScript Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://bucklescript.github.io/blog/feed.xml" title="BuckleScript Blog RSS Feed"/><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logos/bucklescript_small.svg"/><h2 class="headerTitle">BuckleScript</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/docs/ja/installation.html" target="_self">ドキュメント</a></li><li><a href="/docs/ja/playground.html" target="_self">試してみる</a></li><li><a href="/docs/ja/stdlib-overview.html" target="_self">API</a></li><li><a href="/docs/ja/community.html" target="_self">コミュニティ</a></li><li><a href="/blog" target="_self">ブログ</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg"/>日本語</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/en">English</a></li><li><a href="/es-ES">Español</a></li><li><a href="/fr">Français</a></li><li><a href="/ko">한국어</a></li><li><a href="/pt-BR">Português (Brasil)</a></li><li><a href="/ru">Русский</a></li><li><a href="/zh-CN">中文</a></li><li><a href="/zh-TW">繁體中文</a></li><li><a href="https://crowdin.com/project/bucklescript" target="_blank">翻訳に参加する</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/bucklescript/bucklescript" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Advanced</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>はじめに</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/what-why.html">What &amp; Why</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/installation.html">インストール</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/new-project.html">新しいプロジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/concepts-overview.html">基本コンセプト</a></li></ul></div><div class="navGroup navGroupActive"><h3>相互運用</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/interop-overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/interop-cheatsheet.html">チートシート</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/embed-raw-javascript.html">生の JavaScript を埋め込む</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/common-data-types.html">基本的なデータ型</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/intro-to-external.html">Intro to External</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/boolean.html">ブール値</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/bind-to-global-values.html">グローバル変数のバインド</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/null-undefined-option.html">Null、Undefined、オプション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/object.html">オブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/class.html">クラス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/function.html">関数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/import-export.html">インポート / エクスポート</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/regular-expression.html">正規表現</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/exceptions.html">例外</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/json.html">JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/generate-converters-accessors.html">コンバーターとヘルパーの生成</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/nodejs-special-variables.html">NodeJS の特殊な変数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/interop-misc.html">その他</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/typescript-support.html">TypeScript サポート</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/browser-support-polyfills.html">ブラウザー対応と Polyfill</a></li></ul></div><div class="navGroup navGroupActive"><h3>ビルドシステム</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/build-overview.html">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/build-configuration.html">設定</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/automatic-interface-generation.html">インターフェースの自動生成</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/interop-with-js-build-systems.html">JavaScript ビルド システムとの相互運用</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/build-performance.html">パフォーマンス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/build-advanced.html">高度な設定</a></li></ul></div><div class="navGroup navGroupActive"><h3>標準ライブラリ</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/stdlib-overview.html">概要</a></li></ul></div><div class="navGroup navGroupActive"><h3>高度な設定</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/conditional-compilation.html">条件付きコンパイル</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/extended-compiler-options.html">拡張コンパイラ オプション</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/use-existing-ocaml-libraries.html">既存のOCamlのライブラリを使う</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/ja/difference-from-native-ocaml.html">ネイティブ OCaml との違い</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/compiler-architecture-principles.html">コンパイラのアーキテクチャと原則</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/comparison-to-jsoo.html">Js_of_ocaml との比較</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/bucklescript/ja" target="_blank">Translate</a><h1>ネイティブ OCaml との違い</h1></header><article><div><span><p>This is particularly important when porting an existing OCaml application to JavaScript.</p>
<h2><a class="anchor" aria-hidden="true" name="custom-data-type"></a><a href="#custom-data-type" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom Data Type</h2>
<p>In OCaml, the C FFI allows the user to define a custom data type and customize <code>caml_compare</code>, <code>caml_hash</code> behavior, etc. This is not available in our backend (since we have no C FFI).</p>
<h2><a class="anchor" aria-hidden="true" name="physical-in-equality"></a><a href="#physical-in-equality" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Physical (in)equality</h2>
<p>In general, only use physical equality as an optimization technique; don't rely on its correctness, since it is tightly coupled with the runtime.</p>
<h2><a class="anchor" aria-hidden="true" name="string-char-range"></a><a href="#string-char-range" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>String Char Range</h2>
<p>Currently, BuckleScript assumes that the char range is 0-255. The user should be careful when they pass a JavaScript string to the OCaml side. We are working on a solution for this problem.</p>
<h2><a class="anchor" aria-hidden="true" name="weak-map"></a><a href="#weak-map" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Weak Map</h2>
<p>OCaml’s weak map is not available in BuckleScript. The weak pointer is replaced by a strict pointer.</p>
<h2><a class="anchor" aria-hidden="true" name="integers"></a><a href="#integers" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Integers</h2>
<p>OCaml has <code>int</code>, <code>int32</code>, <code>nativeint</code> and <code>int64</code> types.</p>
<ul>
<li>Both <code>int32</code> and <code>int64</code> in BuckleScript have the exact same semantics as OCaml.</li>
<li><code>int</code> in BuckleScript is the same as <code>int32</code> while in OCaml it’s platform dependent.</li>
<li><code>nativeint</code> is treated as JavaScript float, except for division. For example, <code>Nativeint.div a b</code> will be translated into <code>a / b | 0</code>.</li>
</ul>
<p><strong>Note</strong>: <code>Nativeint.shift_right_logical x 0</code> is different from <code>Int32.shift_right_local x 0</code>. The former is literally translated into <code>x &gt;&gt;&gt; 0</code> (translated into an unsigned int), while the latter is <code>x | 0</code>.</p>
<h2><a class="anchor" aria-hidden="true" name="printfprintf"></a><a href="#printfprintf" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Printf.printf</h2>
<p>The Printf.print implementation in BuckleScript requires a newline (<code>\n</code>) to trigger the printing. This behavior is not consistent with the buffered behavior of native OCaml. The only potential problem we foresee is that if the program terminates with no newline character, the text will never be printed.</p>
<h2><a class="anchor" aria-hidden="true" name="obj-module"></a><a href="#obj-module" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Obj Module</h2>
<p>We do our best to mimic the native compiler, but we have no guarantee and there are differences.</p>
<h2><a class="anchor" aria-hidden="true" name="hashtbl-hash-algorithm"></a><a href="#hashtbl-hash-algorithm" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hashtbl Hash Algorithm</h2>
<p>BuckleScript uses the same algorithm as native OCaml, but the output is different due to the runtime representation of int/int64/int32 and float.</p>
<h2><a class="anchor" aria-hidden="true" name="marshall-module"></a><a href="#marshall-module" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Marshall Module</h2>
<p>Not supported yet.</p>
<h2><a class="anchor" aria-hidden="true" name="sysargv-sysmax-array-length-sysmax-string-length"></a><a href="#sysargv-sysmax-array-length-sysmax-string-length" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sys.argv, Sys.max_array_length, Sys.max_string_length</h2>
<p>Command line arguments are always empty. This might be fixed in the future. <code>Sys.max_array_length</code> and <code>Sys.max_string_length</code> will be the same as <code>max_int</code>, but it might be respected.</p>
<h2><a class="anchor" aria-hidden="true" name="unsupported-io-primitives"></a><a href="#unsupported-io-primitives" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Unsupported IO Primitives</h2>
<p>Because of the JS environment limitation, <code>Pervasives.stdin</code> is not supported but both <code>Pervasives.stdout</code> and <code>Pervasives.stderr</code> are.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="use-existing-ocaml-libraries.html">← 既存のOCamlのライブラリを使う</a><a class="docs-next button" href="compiler-architecture-principles.html">コンパイラのアーキテクチャと原則 →</a></div></div></div></div><span><script src="/js/redirectBlog.js"></script><script src="/js/pjax-api.js"></script><script>window.foo = new Pjax({
          areas: [
            // try to use the first query.
            '.mainContainer, .docsNavContainer .toc .navWrapper',
            // fallback
            'body'
          ],
          link: '.docsNavContainer:not(.docsSliderActive) a',
          update: {
            script: false,
          }
        });
        var languagesMenuItemCopy = document.getElementById("languages-menu");
        languagesMenuItemCopy.addEventListener("click", function(e){
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
        });</script></span></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: '0fd97db83891aa20810559812d9e69ac',
                indexName: 'bucklescript',
                inputSelector: '#search_input_react'
              });
            </script></body></html>